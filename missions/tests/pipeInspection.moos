ServerHost = localhost
ServerPort = 9000
Community  = VICI_FOLLOWING_ES

MOOSTimeWarp = 1

ProcessConfig = ANTLER
{
  MSBetweenLaunches = 200

  Run = MOOSDB		@ NewConsole = true
  //Run = pLogger         @ NewConsole = true
  //Run = uSimMarine	@ NewConsole = true
  //Run = pNodeReporter	@ NewConsole = true
  Run = pMarinePID	@ NewConsole = true
  //Run = pMarineViewer	@ NewConsole = true
  Run = pHelmIvP	@ NewConsole = false

  Run = iCISCREA 
  Run = iCamera @ NewConsole = false ~ iCamera_BOTTOM
  Run = iCamera @ NewConsole = false ~ iCamera_SIDE

  
  Run = uTimerScript  @ NewConsole = false

}

ProcessConfig = uTimerScript
{
  AppTick = 2
  CommsTick = 2

  reset_time = end
  delay_reset = 5

  event = var=SPEED, val=0.1, time=1
  event = var=DESIRED_SPEED, val=0.1, time=1
}

ProcessConfig = pHelmIvP
{
  AppTick    = 4
  CommsTick  = 4

  IVP_BEHAVIOR_DIR  = ../../lib
  Behaviors         = pipeInspection.bhv
  Verbose           = verbose
  Domain            = course:0:359:360
  Domain            = depth:0:10:200
  ok_skew           = any
  active_start      = true
}


ProcessConfig = iCamera_BOTTOM
{
  VARIABLE_IMAGE_NAME = CAMERA_BOTTOM
  IDENTIFIANT_CV_CAMERA = 0
  DISPLAY_IMAGE = false
  INVERT_IMAGE = true
}

ProcessConfig = iCamera_SIDE
{
  VARIABLE_IMAGE_NAME = CAMERA_SIDE
  IDENTIFIANT_CV_CAMERA = 1
  DISPLAY_IMAGE = false
  INVERT_IMAGE = false
}


ProcessConfig = iCISCREA
{
  AppTick   = 4
  CommsTick = 4

  //Serial port 
  SERIAL_PORT = /dev/ttyUSB0
                                                                
  // Max number of retries before giving up
  MAX_MODBUS_RETRIES = 10
  MAX_TURNON_RETRIES = 100
                                                                
  // Lower and upper bound for motors deadzone
  FRRI_LO_DZ = 0
  RERI_LO_DZ = 0
  RELE_LO_DZ = 0
  FRLE_LO_DZ = 0
  VERT_LO_DZ = 0
  FRRI_UP_DZ = 0
  RERI_UP_DZ = 0
  RELE_UP_DZ = 0
  FRLE_UP_DZ = 0
  VERT_UP_DZ = 0
                                                                
  // Motors' sens of rotation (when the motor value is positive, motors should push water away from the body.
  FRRI_SENS = 1
  RERI_SENS = 1
  RELE_SENS = 1
  FRLE_SENS = 1
  VERT_SENS = 1

  DEPTH_OFFSET = -0.02
}

ProcessConfig = pMarinePID
{
  AppTick    = 10
  CommsTick  = 10
  
  tardy_helm_threshold = 100.0                                    
  tardy_nav_threshold  = 100.0

  VERBOSE       = true
  DEPTH_CONTROL = true
  ACTIVE_START  = true
  
  // Yaw PID controller
  YAW_PID_KP             = 0.2
  YAW_PID_KD             = 1.0
  YAW_PID_KI             = 0.0
  YAW_PID_INTEGRAL_LIMIT = 0.07
  
  // Speed PID controller
  SPEED_PID_KP           = 1.0
  SPEED_PID_KD           = 0.0
  SPEED_PID_KI           = 0.0
  SPEED_PID_INTEGRAL_LIMIT = 0.07
  
  //Pitch PID controller
  PITCH_PID_KP                   = 1.0
  PITCH_PID_KD                   = 1.0
  PITCH_PID_KI                   = 0
  PITCH_PID_INTEGRAL_LIMIT       = 0

  //ZPID controller
  Z_TO_PITCH_PID_KP              = 7.0
  Z_TO_PITCH_PID_KD              = 0
  Z_TO_PITCH_PID_KI              = 0.00
  Z_TO_PITCH_PID_INTEGRAL_LIMIT  = 0.05

  // Maximums
  MAXRUDDER   = 3
  MAXTHRUST   = 100
  MAXPITCH    = 50
  MAXELEVATOR = 100
  
  // A non-zero SPEED_FACTOR overrides use of SPEED_PID
  // Will set DESIRED_THRUST = DESIRED_SPEED * SPEED_FACTOR
  SPEED_FACTOR = 10
}